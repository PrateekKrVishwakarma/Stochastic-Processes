  \documentclass[a4paper,10pt]{article}
\usepackage{amsmath,amssymb}
\usepackage{amsthm}
\usepackage[colorlinks]{hyperref}

\newtheorem{prop}{Proposition}
\newtheorem{defi}{Definition}
\newtheorem{theo}{Theorem}
\newtheorem{lem}{Lemma}

\title{SPQT Lecture 4: Key Renewal Theorem and Applications}
\author{Prof. Parimal Parag}

\begin{document}
\maketitle
\section{Renewal Theory Contd. - Key Renewal Theorem and Applications}


\subsection{Directly Riemann Integrals}
A function $h: [0,\infty] \rightarrow \mathbb{R}$ is \textit{directly Riemann integrable} (dRi) if the partial sums obtained by summing the infimum and supremum of $h$, taken over intervals obtained by partitioning the positive axis, both converges to the same limit, for all finite positive interval lengths. That is,
  \begin{flalign}
  \lim_{\delta \rightarrow 0} \delta \sum_{k=0}^{\infty}\sup_{ u \in [(n-1)\delta,n\delta]}h(u)=\lim_{\delta \rightarrow 0} \delta \sum_{k=0}^{\infty}\inf_{ u \in [(n-1)\delta,n\delta]}h(u)  
  \end{flalign}   
  If both limits exist and are equal, the integral value is equal to the limit. Compare this definition with the definition of Riemann integrals. A function $g: [0, M] \rightarrow \mathbb{R} $ is Riemann integrable if 
   \begin{eqnarray*}
  \lim_{\delta \rightarrow 0} \delta \sum_{k=0}^{M/\delta}\sup_{ u \in [(n-1)\delta,n\delta]}g(u)=\lim_{\delta \rightarrow 0} \delta \sum_{k=0}^{M/\delta}\inf_{ u \in [(n-1)\delta,n\delta]}g(u)  
  \end{eqnarray*} 
   and in that case, limit is the value of the integral. For $h$ defined on $[0,\infty]$, $\int_{0}^{\infty}h(u)du = \lim_{M \rightarrow \infty}\int_{0}^{M}h(u)du$, if the limit exists. For many functions, this limit may not exist.  \\
  \textbf{Remarks:}
  \begin{enumerate}
  \item If $h$ is bounded and continuous and $h$ is non increasing, then $h$ is dRi.  \\
  \item  If $h\leq h'$ and $h'$ is dRi, then $h$ is dRi.\\
  \item If $h$ is dRi, $ \int_{0}^{\infty}h(s)ds < \infty$ and if in addition $h$ is non-negative, $\lim_{t \rightarrow \infty} h(t)=0$.
  \end{enumerate}

\subsection{Key Renewal Theorem}
\begin{theo}
If $F$ is non lattice, and if a function $h(t)$ is dRI then,
\begin{flalign}
\lim_{t \rightarrow \infty} \int_{0}^{\infty}h(t-x)dm(x)=\frac{1}{\mu}\int_{0}^{\infty}h(t)dt,
\end{flalign}
where $m(x)=\mathbb{E}[N(x)]=\sum_{n \in \mathbb{N}}P(N(x)\geq n)=\sum_{n \in \mathbb{N}}P(S_n\leq x), \mu= \int_{0}^{\infty}F^c(t).$
\end{theo}
\textbf{Remark:} Blackwell's theorem and key renewal theorem are equivalent and we can deduce one theorem from the other. To see how we can prove the key renewal theorem from Blackwell's theorem, observe from Blackwell's theorem that,
\begin{flalign*}
&\lim_{a \rightarrow 0}\lim_{t \rightarrow \infty} \frac{m(t
+a)-m(t)}{a}=\frac{1}{\mu}\\
&\stackrel{(a)}{\Rightarrow}\lim_{t \rightarrow \infty}\frac{dm(t)}{dt}=\frac{1}{\mu},
\end{flalign*}     
where in $(a)$ we justify the exchange the order of limits as follows:  
\begin{theo}
\begin{flalign}
P(S_{N(t)}\leq s)=F^c(t)+\int_{0}^{s}F^c(t-y)dm(y),~ t\geq s \geq 0.
\end{flalign}
\end{theo} 

\begin{proof}
\begin{flalign*}
P(S_{N(t)} \leq s)&= \sum_{n \in \mathbb{N}_0}P( S_{N(t)} \leq s, N(t)=n)\\
&= \sum_{n \in \mathbb{N}_0}P( S_{n} \leq s, N(t)=n)\\
&= \sum_{n \in \mathbb{N}_0}P( S_{n} \leq s, S_{n+1} > t)\\
&= P(S_1 >t) +\sum_{n \in \mathbb{N}}P( S_{n} \leq s, S_{n+1} > t)\\
&= P(X_1 >t) +\sum_{n \in \mathbb{N}}\int_{y=0}^{s}P( S_{n+1} > t|S_n=y)dF_n(y)\\
&= P(X_1 >t) +\sum_{n \in \mathbb{N}}\int_{y=0}^{s}P( X_{n+1} > t-y)dF_n(y)\\
&= P(X_1 >t) +\sum_{n \in \mathbb{N}}\int_{y=0}^{s}F^c(t-y)dF_n(y)\\
&\stackrel{(a)}{=} P(X_1 >t) +\int_{y=0}^{s}F^c(t-y)\sum_{n \in \mathbb{N}}dF_n(y),\\
\end{flalign*}
where the order of summation is exchanged by virtue of the fact that the summands are non-negative and the sum is finite (Fubini's theorem).
\end{proof}

\textbf{Remarks:}
\begin{enumerate}
\item $P(S_{N(t)}=0)=F^c(t)$, $dF_{S_{N(t)}}(y)=F^c(t-y)dm(y)$.\\
\item Let $F$ be continuous with density function $f$. Then, 
\begin{flalign*}
dm(y)&=\sum_{n \in \mathbb{N}}f_n(y)dy\\
&=\sum_{n \in \mathbb{N}}P(n^{\text{th}} \text{renewal occurs in} (y,y+dy))\\
&=P(\text {renewal occurs in }(y,y+dy)).
\end{flalign*}
Hence,
\begin{flalign*}
dF_{S_{N(t)}}(y)=P(\text{renewal occurs in }(y,y+dy)) \text{ and next arrival after}~ t-y).
\end{flalign*}
\end{enumerate}
\subsection{Alternate Renewal Processes}
Alternating renewal processes form an important class of renewal processes and we find one natural application of  key renewal theorem  in this section. Let $\{(Z_n,Y_n),~n \in \mathbb{N}\}$ be an iid process. Note that $Y_n$ and $Z_n$ can be dependent. Let $Y_n \sim G$, $Z_n \sim H, F \sim Z_n+Y_n \triangleq X_n$. The random variable $Z_n$ denotes the ON time of a system and $Y_n$ denotes the OFF time of the system. Let $P(t)=P(\text{ON at time}~ t)$.
\begin{theo}
If $\mathbb{E}[Z_n+Y_n]< \infty $ and $F$ is non-lattice, then
\begin{flalign*}
\lim_{t \rightarrow \infty}P(t)=\frac{\mathbb{E}[Z_n]}{\mathbb{E}[Y_n]+\mathbb{E}[Z_n]}.
\end{flalign*}
 \end{theo} 
 \begin{proof}
\begin{flalign*}
P(t)&= P(\text{ON at time t}, S_{N(t)}=0)+P(\text{ON at time t}, S_{N(t)}>0)\\
&=P(\text{ON at time t}, S_{N(t)}=0)+\int_{y=0}^{t}P(\text{ON at time t}| S_{N(t)}=y)dF_{S_{N(t)}}(y)\\
&=P(Z_1>t)+\int_{y=0}^{t}P(Z>t-y| Z+Y > t-y)dF_{S_{N(t)}}(y)\\
&\stackrel{(a)}{=}H^c(t)+\int_{y=0}^{t}\frac{H^c(t-y)}{F^c(t-y)}F^c(t-y)dm(y)\\
&= H^c(t)+\int_{y=0}^{t}H^c(t-y))dm(y),\\
\end{flalign*}
where $(a)$ follows from the remark following Theorem 3.Now apply key renewal theorem to obtain the required result. Since $H^c(t) \rightarrow 0$ as $t \rightarrow \infty$, we get
\begin{flalign}
P(t) \rightarrow \frac{\int_{0}^{\infty}H^c(t)dt}{\mu}=\frac{\mathbb{E}[Z_n]}{\mathbb{E}[Y_n]+\mathbb{E}[Z_n]}.
\end{flalign}
\end{proof}

Many processes of practical interest can be modelled by an alternate renewal process. For example, consider a renewal process and let $A(t)$ be the time from $t$ since the last renewal and $Y(t)$ be the time from $t$ till the next renewal. That is,
\begin{flalign*}
&Y(t)=S_{N(t)+1}-t,\\
&A(t)=t-S_{N(t)}.
\end{flalign*}   
Suppose we need to find $\lim_{t \rightarrow \infty}P(A(t) \leq x)$ for some fixed  x. Now, observe that $P(A(t) \leq x)=\mathbb{E}[1_{A(t) \geq x}]$ which is the mean time when the ``age at $t$" is less than $x$ which is equal to $\mathbb{E}[\min\{x,X\}]$. Hence, we get\\
\begin{flalign*}
\lim_{t \rightarrow \infty} P(A(t) \leq x)= \frac{\int_{t=x}^{\infty}F^c(t)dt}{\mu}.
\end{flalign*}  

It is to be mentioned that $P(Y(t)\leq x)$ also yield the same limit as $t \rightarrow \infty$. This can be observed by noting that if we consider the reversed processes (an identically distributed renewal process), $Y(t)$,  the ``excess life time" at $t$ is same as the age at $t$, $A(t)$ of the original process.  
\subsubsection{The Inspection Paradox}
Define $X_{N(t)+1}=A(t)+Y(t)$ as the length of the renewal interval containing $t$, in other words, the length of current renewal interval. Inspection paradox says that $P(X_{N(t)+1} >x)\geq F^c(x)$. That is, for any $x$, the length of the current renewal interval to be greater than $x$ is always more likely than that for an ordinary renewal interval. Formally,
\begin{flalign*}
P(X_{N(t)+1}>x)&= P(X_{N(t)+1}>x, S_{N(t)+1}=0)+P(X_{N(t)+1}>x,  S_{N(t)+1}>0)\\
&\geq  P(X_{N(t)+1}>x, S_{N(t)+1}=0)\\
&= P(X_2 >x)\\
&= F^c(x).

git config --global core.editor "Notepad -w"
\end{flalign*}
\end{document}