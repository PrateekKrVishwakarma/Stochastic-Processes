\documentclass[a4paper,10pt]{article}
\include{header}
\title{Lecture 13: Limiting Probabilities and Reversibility}
\author{Parimal Parag}
\begin{document}
\maketitle


\subsection{Time Reversibility for CTMC}
\begin{prop}
Markov property holds going backward in time. i.e.
\begin{equation*}
Pr(X(t-s)=j|X(t)=i,X(y), y > t)=Pr(X(t-s)=j|X(t)=i).
\end{equation*}
\begin{proof}
\begin{flalign*}
&Pr(X(t-s)=j|X(t)=i, X(y), y>t)=\frac{Pr(X(t-s)=j, X(t)=i, X(y), y>t)}{Pr(X(t)=i, X(y), y>t)}\\
&\stackrel{(a)}{=}\frac{Pr(X(t-s)=j)Pr(X(t)=i|X(t-s)=j)Pr(X(y), y>t|X(t)=i)}{Pr(X(t)=i, X(y), y>t)}\\
&\stackrel{}{=}\frac{Pr(X(t-s)=j)Pr(X(t)=i|X(t-s)=j)}{Pr(X(t)=i)}\\
&\stackrel{}{=}Pr(X(t-s)=j|X(t)=i).\\
\end{flalign*}
where $(a)$ follows from the Markov property of forward chain.  
\end{proof}
\end{prop}
Now we would like to characterize the sojourn time in each state. Since the amount of time spent in each state is same whether in forward or backward direction, one expects the sojourn time for the reverse chain to be exponential with the same parameter $\nu_i$. We can verify this formally:
\begin{flalign*}
&Pr(\text{Process in state i during [t-s,t]}|X(t)=i)\\
&= {Pr(\text{Process in state i during [t-s,t]})}/{Pr(X(t)=i)}\\
&= \frac{Pr(X(t-s)=i)e^{-\nu_i s}}{Pr(X(t)=i)}=e^{-\nu_i s}.\\
\end{flalign*}
Next, we would like to characterize the transition probabilities of the reversed chain. The sequence of states visited by the reverse process constitutes a discrete-time Markov chain with transition probabilities $P_{ij}^*$ give by 
\begin{equation}
P_{ij}^*= \frac{\pi_jP_{ji}}{\pi_i},
\end{equation} 
where $\{\pi_i,~ i \geq 0\}$ are the stationary probabilities of the embeddede discrete time Markov chain with transition probabilities $P_{ij}$. Denote 
\begin{equation}
q_{ij}^*=\nu_iP_{ij}^*
\end{equation}
as the infinitesimal rates of the reversed process. Using the previous formula for $P_{ij}^*$ we see that
\begin{equation}
q_{ij}^*=\frac{\nu_i\pi_jP_{ji}}{\pi_i}.
\end{equation} 
Recall that 
\begin{equation}
P_{k}=\frac{\pi_k / \nu_k}{\sum_{i}\pi_i / \nu_i},
\end{equation}
we see that 
\begin{equation}
\frac{\pi_i}{\pi_j}=\frac{\nu_j P_j}{\nu_i P_i}.
\end{equation}
Hence, 
\begin{equation}
q_{ij}^*=\frac{\nu_j P_{j}P_{ji}}{P_i}= \frac{P_jq_{ji}}{P_i}.
\end{equation}
That is,
\begin{equation*}
P_{i}q_{ij}^*=P_{j}q_{ji}.
\end{equation*}
Form the above equation, it is obvious that 
\begin{equation*}
\sum_{i}P_i q_{ij}^*=0.
\end{equation*} 
This implies that $P_j,~j \geq 0$ are the stationary probabilities for the reverse chain as $P_j$s satisfy the balance equations.
\begin{defn}
A stationary CTMC is said to be time reversible if the reverse process follows the same probabilistic law as the original process. That is, if, for all $i,j$
\begin{equation*}
q_{ij}^*= q_{ij} \iff P_{i}q_{ij}=P_jq_{ji}.
\end{equation*} 
\end{defn} 
\begin{prop}
An ergodic birth and death process is time reversible in steady state.
\end{prop}
\begin{proof}
To prove the above, we must show that the rate at which the process goes from state $i$ to $i+1$ is equal to the rate of going from $i+1$ to $i$. But during any time interval of length $t$, the number of transitions from $i$ to $i+1$ should be within 1 of the number of transitions from $i+1$ to $i$ (since the process is birth and death process. Hence, as $t \rightarrow \infty$,  both rates will be equal. 
\end{proof}

\end{document}